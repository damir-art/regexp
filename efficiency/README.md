# Эффективность
## Жадные выражения (greedy expressions)
- `\d+\w+\d+` - выберет `01_FY_07_report_99`.xls
- `".+", ".+"` - выберет целиком `"Milton", "Waddams", "Initech, Inc."`

Стандартные квантификаторы повторения являются жадными, это означает что выражение (а имменно квантифицированное повторение в данном случае) пытается соответствовать самой длинной возможной строке.

- Регулярные выражения не терпеливы
- Регулярные выражения жадны

## Ленивые выражения (lazy expressions)
Появились в Perl и регулярных выражениях совместимых с Perl.

`?` - make preceding quantifier lazy

Раньше мы рассматривали этот символ и узнали что это модификатор который говорит что предшествующий элемент появляется 0 или 1 раз. В контексте же ленивых выражений `?` превращает предшествующий квантификатор в ленивый квантификатор:

- `*?` - ленивая звездочка
- `+?` - ленивый плюс
- `{min,max}`
- `??`

Делают все тоже самое, только вместо жадной стратегии применяют ленивую стратегию. Жадная стратегия пытается найти как можно большее соответствие, прежде чем отдать управление следующей части выражения, а ленивая стратегия делает обратное, пытается найти как можно меньшее соответствие.

Выбор жадной или ленивой стратегии не обязательно будет быстрее или медленнее. Могут быть получены в итоге разные результаты.

- `\w*?\d{3}` -
- `[A-Za-z-]+?\.` -
- `.{4,8}?_.{4,8}` -
- `apples??` - первый `?` говорит что s может быть 0 или 1 раз, по умолчанию движок жадный поэтому он будет предпочитать 1 раз `apples`, а второй вопросительный знак, говорит быть ленивым `apple`, поэтому такое выражение бессмысленно

## Эффективное использование повторения (using repetition efficiently)
Использование метасимволов повторения, очень сильно влияет на эффективность парсинга регулярных выражений.

- `\w+s` - We picked `apples`.
- `\w*s` - We picked `apples`.

Как сделать регулярное выражение эффективнее при работе с повторениями.

Основное правило:

    Efficient matching + less backtracking = speedy results

Эффективное соответствие + меньше возвращений назад = быстрый результат.

Задать количество повторяемых выражений:
- `.+` быстрее чем `.*`
- `.{5}` и `.{3,7}` еще быстрее

Уменьшить область определения повторяемого выражения:
- вместо `.+` использовать `[A-Za-z]+`,
- ищем только то что нужно, а не то что не нужно.

Предоставлять четкие начальные и конечные точки:
- например ищем тег HTML
- `<.+>` - ищем любой набор символов между угловыми скобками
- `<[^>]+>` - ищем любой символ кроме `>` (это по лучше)

Также к эффективности относятся анкеры и границы слов, они говорят гда начало и конец строки и где начало и конец слов. Также поможет сохранить время.

Итог по улучшению эффективности (пытайтесь быть настолько конкретными насколько это возможно):
- `\w*s` на `\w+s`, звездочку заменяем на плюс
- `\w+s` на `[A-Za-z]+s`, плюс заменяем на конкретный набор символов
- `[A-Za-z]+s` можно заменить на:
  - `[a-z]+s` поиск слов только со строчными буквами
  - `[A-Z][a-z]+s` поиск слов начинающихся с прописной
- ищите слово целиком, добавляя пробелы в начале и в конце
